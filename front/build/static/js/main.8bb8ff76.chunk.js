(this.webpackJsonptakeplace=this.webpackJsonptakeplace||[]).push([[0],{388:function(e,t,n){},395:function(e,t,n){"use strict";n.r(t);n(188),n(376);var r=n(2),c=n.n(r),a=n(57),o=n.n(a),u=(n(388),n(43)),s=n(58),i=n(60),l=n(59),d=n(14),j=n.n(d),h=n(31),O=function e(){var t=this;Object(u.a)(this,e),this._base="http://localhost:5000",this.sendRequest=function(){var e=Object(h.a)(j.a.mark((function e(n,r,c){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._base).concat(n),{method:r,mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}).then((function(e){return e.status<=200?e.json():e.json().then((function(e){return Promise.reject(e)})).then((function(e){return e}))}));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),this.checkResource=Object(h.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.sendRequest("/checkData","GET"));case 1:case"end":return e.stop()}}),e)}))),this.check=Object(h.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.sendRequest("/check","GET"));case 1:case"end":return e.stop()}}),e)}))),this.getResource=Object(h.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.sendRequest("/","GET"));case 1:case"end":return e.stop()}}),e)}))),this.getResourceToFloor=function(){var e=Object(h.a)(j.a.mark((function e(n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.sendRequest("/".concat(n),"GET"));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.changeResource=function(){var e=Object(h.a)(j.a.mark((function e(n,r){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={number:n,date:r},e.abrupt("return",t.sendRequest("/update","PUT",c));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},b=function(e){var t=e[0].map((function(e){return{floor:e.Name[0],room:e.Name[1],data:f(e.Data),status:e.Status}}));return t},f=function(e){if(null!==e){var t=e[14]+e[15],n=e[11]+e[12],r=e[8]+e[9],c=e[5]+e[6];return"\u0414\u043e ".concat(r,".").concat(c," ").concat(n,":").concat(t)}},p=function(e){return{floor:"".concat(e[0][0].floorId," \u044d\u0442\u0430\u0436"),room:e[0][0].Name,data:f(e[0][0].Data),status:e[0][0].Status}},m=function(e){var t=[],n=[];return e.forEach((function(e){var r=e.floor;n.includes(r)||(n.push(r),t.push(r))})),t.length},v=new O,x=function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:localStorage.setItem("current_floor",e),n({type:"LOADING_ROOMS"}),v.getResourceToFloor(e).then((function(e){return b(e)})).then((function(e){return n({type:"SUCCESS_ROOMS_TO_FLOOR",payload:e})})).catch((function(e){return n({type:"FAILURE_ROOMS",payload:e})}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},_=n(1),y=function(e){var t=function(e){var t=[],n=localStorage.getItem("current_floor");return e.forEach((function(e){e.floor==="".concat(n," \u044d\u0442\u0430\u0436")&&t.push(Object(_.jsxs)("li",{className:"place place__".concat(e.status),children:[Object(_.jsx)("div",{children:e.room}),Object(_.jsx)("div",{children:e.status}),Object(_.jsx)("div",{children:e.data})]},e.room))})),t}(e.rooms);return Object(_.jsx)("ul",{className:"inner__room",children:t})},S=n(30),R=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).ajax=new O,e.checkRoomS=function(){e.ajax.checkResource().then((function(){return e.props.getRoomsInitial()}))},e}return Object(s.a)(n,[{key:"componentDidMount",value:function(){localStorage.setItem("current_floor",1),this.props.getRoomsInitial(),this.interval=setInterval(this.checkRoomS,1e4)}},{key:"render",value:function(){var e=this.props.RoomReducer,t=e.rooms;e.error;return e.loading?Object(_.jsx)("div",{children:"...Loading"}):Object(_.jsx)("div",{children:Object(_.jsx)(y,{rooms:t})})}}]),n}(c.a.Component),g=Object(S.b)((function(e){return{RoomReducer:e.RoomReducer}}),(function(e){return{getRoomsInitial:function(){return e(function(){var e=Object(h.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOADING_ROOMS"}),v.getResource().then((function(e){return b(e)})).then((function(e){t({type:"SUCCESS_ROOMS_INITIAL",payload:e}),t({type:"GET_FLOORS",payload:m(e)})})).catch((function(e){return t({type:"FAILURE_ROOMS",payload:e})}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},getRoomsUseFloor:function(t){return e(x(t))}}}))(R),w=n(44),N=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).el=document.createElement("div"),r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){document.body.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.el)}},{key:"render",value:function(){var e=this.props.children;return o.a.createPortal(e,this.el)}}]),n}(c.a.Component),E=function(){var e=Object(r.useState)(!1),t=Object(w.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),o=Object(w.a)(a,2),u=o[0],s=o[1],i=Object(r.useState)(null),l=Object(w.a)(i,2),d=l[0],b=l[1],f=Object(r.useState)(null),m=Object(w.a)(f,2),v=m[0],x=m[1],y=Object(r.useState)(null),R=Object(w.a)(y,2),g=R[0],E=R[1],I=Object(r.useState)(null),k=Object(w.a)(I,2),C=k[0],T=k[1],L=Object(r.useState)(null),F=Object(w.a)(L,2),A=F[0],M=F[1],U=Object(S.c)(),q=new O,D=function(){c(!1),M(null),s(null),b(null),x(null),E(null),T(null)},G=n?Object(_.jsx)(N,{children:Object(_.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),function(){var e=document.querySelectorAll("input");return Array.prototype.some.call(e,(function(e){return 0===e.value.length}))}())return M("write in all fields!");var t=[g,C,d,v];q.changeResource(u,t).then((function(e){return U(function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e){t.next=2;break}return t.abrupt("return");case 2:n({type:"CHANGE_STATUS_ROOM",payload:p(e)});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(e))})).then((function(){return U((function(e){e({type:"SET_VISIBLE"})})),void D()})).catch((function(e){var t=e.error;return M(t)}))},children:Object(_.jsx)("div",{className:"modal",children:Object(_.jsxs)("div",{className:"modal__window",children:[Object(_.jsx)("div",{className:"modal__exit",onClick:D,children:"X"}),Object(_.jsx)("h3",{className:"modal__header",children:"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0438 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u0443\u044e \u043a\u043e\u043c\u043d\u0430\u0442\u0443"}),Object(_.jsxs)("div",{className:"modal__body",children:[Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{children:"\u041a\u043e\u043c\u043d\u0430\u0442\u0430(\u043d\u043e\u043c\u0435\u0440)"}),Object(_.jsx)("input",{type:"text",name:"number",id:"number",onChange:function(e){return s(e.target.value)}})]}),Object(_.jsxs)("div",{className:"modal__dates",children:[Object(_.jsx)("header",{children:"\u0414\u0430\u0442\u0430"}),Object(_.jsxs)("div",{className:"modal__dates_day_month",children:[Object(_.jsxs)("span",{children:[Object(_.jsx)("div",{children:"\u0414\u0435\u043d\u044c"}),Object(_.jsx)("input",{maxLength:"2",type:"text",name:"day",id:"day",onChange:function(e){return b(e.target.value)}})]}),Object(_.jsxs)("span",{children:[Object(_.jsx)("div",{children:"\u041c\u0435\u0441\u044f\u0446"}),Object(_.jsx)("input",{maxLength:"2",type:"text",name:"month",id:"month",onChange:function(e){return x(e.target.value)}})]})]}),Object(_.jsxs)("div",{className:"modal__dates_day_month",children:[Object(_.jsxs)("span",{children:[Object(_.jsx)("div",{children:"\u0427\u0430\u0441\u044b"}),Object(_.jsx)("input",{maxLength:"2",type:"text",name:"hour",id:"hour",onChange:function(e){return E(e.target.value)}})]}),Object(_.jsxs)("span",{children:[Object(_.jsx)("div",{children:"\u041c\u0438\u043d\u0443\u0442\u044b"}),Object(_.jsx)("input",{maLength:"2",type:"text",name:"minutes",id:"minutes",onChange:function(e){return T(e.target.value)}})]})]})]}),Object(_.jsx)("div",{})]}),Object(_.jsx)("div",{className:"modal__footer",children:Object(_.jsx)("button",{type:"submit",children:"\u0417\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),A&&Object(_.jsx)("div",{className:"modal__warning",children:A})]})})})}):null;return Object(_.jsxs)("div",{className:"modal__btn",children:[Object(_.jsx)("button",{onClick:function(){c(!0),U((function(e){e({type:"UNSET_VISIBLE"})}))},children:"\u0437\u0430\u043d\u044f\u0442\u044c \u043c\u0435\u0441\u0442\u043e"}),G]})},I=function(){return Object(_.jsx)("header",{className:"header",children:Object(_.jsx)(E,{})})},k=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"render",value:function(){return this.props.visible?Object(_.jsx)("div",{className:"successWindow",children:"\u041c\u0435\u0441\u0442\u043e \u0437\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0443\u0441\u043f\u0435\u0448\u043d\u043e!"}):Object(_.jsx)("div",{})}}]),n}(c.a.Component),C=Object(S.b)((function(e){return{visible:e.SuccessWindowReducer.visible}}))(k),T=function(e){for(var t=[],n=0;n<e;n++)t.push(Object(_.jsx)("option",{value:n+1,children:"".concat(n+1," \u044d\u0442\u0430\u0436")},n+1));return t},L=function(){var e=Object(S.d)((function(e){return e.FloorReducer.qtyFloor})),t=Object(S.c)();new O;return Object(_.jsx)("select",{className:"selectFloor",onChange:function(){var e=document.querySelector(".selectFloor").selectedIndex;t(x(e+1))},children:T(e)})};var F=function(){return Object(_.jsxs)("div",{className:"App",children:[Object(_.jsx)(I,{}),Object(_.jsx)(C,{}),Object(_.jsx)("div",{className:"container",children:Object(_.jsxs)("div",{className:"room",children:[Object(_.jsx)(L,{}),Object(_.jsx)(g,{})]})})]})},A=n(51),M=n(123),U=n(124),q=function(e,t){var n=e.rooms,r=n.findIndex((function(e){return e.room===t.room})),c=n[r],a=Object(U.a)(Object(U.a)({},c),{},{data:t.data,status:t.status});return[].concat(Object(M.a)(n.slice(0,r)),[a],Object(M.a)(n.slice(r+1)))},D=n(187),G=Object(A.c)({RoomReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{rooms:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING_ROOMS":return{loading:!0,rooms:[],error:null};case"SUCCESS_ROOMS_INITIAL":case"SUCCESS_ROOMS_TO_FLOOR":return{loading:!1,rooms:t.payload,error:null};case"FAILURE_ROOMS":return{loading:!1,rooms:[],error:t.payload};case"CHANGE_STATUS_ROOM":return{rooms:q(e,t.payload)};default:return e}},SuccessWindowReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{visible:!1},t=arguments.length>1?arguments[1]:void 0;switch(console.log("redux was here!",t.type),t.type){case"SET_VISIBLE":return{visible:!0};case"UNSET_VISIBLE":return{visible:!1};default:return e}},FloorReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{qtyFloor:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_FLOORS":return{qtyFloor:t.payload};default:return e}}}),B=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||A.d,V=Object(A.e)(G,B(Object(A.a)(D.a)));o.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(S.a,{store:V,children:Object(_.jsx)(F,{})})}),document.getElementById("root"))}},[[395,1,2]]]);
//# sourceMappingURL=main.8bb8ff76.chunk.js.map